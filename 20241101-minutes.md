## S3 Working Group Minutes

Friday, 2024/11/01

3:00 pm ET

## Attendees:

Terrell Russell, Kory Draughn, Alan King, Justin James, Tony Edgin (CyVerse), Nirav Merchant (CyVerse)

## Minutes

DISCUSSION

 - iRODS S3 API
   - No updates, it's perfect.
 - S3 plugin - Attach a bucket to a logical_path
   - Tony wants a unicorn
   - No updates
 - Async iRODS and Illyoung fuse ideas
   - Git clone is 1000s of tiny, with many/some temporary files
     - Concept of a cooldown / settling
     - Not just slow... actually BROKEN b/c sync errors
   - Batching would reduce the number of network calls
     - ibun - not available to fuse - doesn't know when new tiny files are done landing
     - bput then extraction on server, then registering (is currently slow)
   - Cache server / delay window
     - Perhaps the cleanest for the widest set of scenarios
     - Data agnostic
     - Temp files can come and go and never be seen by iRODS
     - On the client side, with a knob for delay… 5s?
     - Rclone has options around this one - the client side
     - https://rclone.org/commands/rclone_mount/#vfs-file-caching
     - Our favorite
       - --vfs-write-back duration
       - Time to writeback files after last use when using cache (default 5s)
     - Summer internship?  For CyVerse?
       - Add an iRODS backend to rclone (Go)
   - Aysnc would 'fix' the slow feeling
     - But then has to buffer the truth
     - Cache management
   - Current CyVerse
     - Both latency and consistency issues
     - Pre locking 4.2.8
     - In go client library… Create a file in one connection, other existing connection doesn't see the new file
       - Why doesn't the existing connection do a new query?  It should hit the catalog and see the new/correct truth.
       - Has this happened with any other client library?  Not sure.
     - Poor mans rollback in 2021
       - https://github.com/cyverse/go-irodsclient/pull/8/files
       - When things are unhappy, just send a bad API call, and the transactions are cleaned up
     - Would like to box this against 4.2.8 and then test against 4.3.3 too
       - Illyoung has a long-running scenario that breaks sometimes/rarely against 4.2.8
       - Has not seen/proved the same error against a newer iRODS version
       - Maybe we put git clone in the test itself, b/c lots of tiny files
     - Other alternative is a data cache store layer beside CyVerse datastore
       - But now you have to manage that too!
   - iRODS learns infiniband?  Wouldn't fix it, but would help make the windows smaller.
 - Next Meeting
   - Feb 2025
